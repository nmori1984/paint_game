<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お題ルーレット</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="screen" id="screen-title">
        <div class="roulette-container">
            <div id="titleRouletteDisplay" class="roulette-display">???</div>
            <div class="roulette-buttons">
                <button id="titleRouletteBtn" class="main-btn">お題ルーレット</button>
                <button id="editTitleBtn" class="edit-btn">✎</button>
            </div>
        </div>
        
        <!-- 管理者ツールボタン -->
        <div class="admin-container">
            <button id="backToGameBtn" class="admin-btn">ゲーム画面に戻る</button>
        </div>
    </div>
    
    <!-- お題編集モーダル -->
    <div id="editTitleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>お題リスト編集</h2>
                <button id="closeTitleModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p class="modal-instruction">1行に1つのお題を入力してください</p>
                <textarea id="titlesTextarea" rows="20"></textarea>
            </div>
            <div class="modal-footer">
                <button id="saveTitlesBtn" class="save-btn">保存</button>
                <button id="cancelTitleBtn" class="cancel-btn">キャンセル</button>
            </div>
        </div>
    </div>
    
    <script src="roulette.js"></script>
    <script>
    // お題ルーレット用のJS
    async function fetchTitles() {
        try {
            const response = await fetch('title.txt');
            if (!response.ok) {
                throw new Error('title.txtの読み込みに失敗しました');
            }
            const text = await response.text();
            return text.split('\n').filter(line => line.trim() !== '');
        } catch (error) {
            console.error('エラー:', error);
            return [];
        }
    }
    let titles = [];
    fetchTitles().then(list => { 
        titles = list;
        console.log('読み込んだお題:', titles);
    });
    document.getElementById('titleRouletteBtn').onclick = function() {
        if (titles.length === 0) {
            document.getElementById('titleRouletteDisplay').textContent = 'エラー';
            return;
        }
        const idx = Math.floor(Math.random() * titles.length);
        document.getElementById('titleRouletteDisplay').textContent = titles[idx];
    };
    
    // お題編集ボタン
    const editTitleModal = document.getElementById('editTitleModal');
    const editTitleBtn = document.getElementById('editTitleBtn');
    const closeTitleModal = document.getElementById('closeTitleModal');
    const cancelTitleBtn = document.getElementById('cancelTitleBtn');
    const saveTitlesBtn = document.getElementById('saveTitlesBtn');
    const titlesTextarea = document.getElementById('titlesTextarea');

    editTitleBtn.onclick = function() {
        titlesTextarea.value = titles.join('\n');
        editTitleModal.style.display = 'flex';
    };

    closeTitleModal.onclick = function() {
        editTitleModal.style.display = 'none';
    };

    cancelTitleBtn.onclick = function() {
        editTitleModal.style.display = 'none';
    };

    saveTitlesBtn.onclick = function() {
        const text = titlesTextarea.value;
        titles = text.split('\n').filter(line => line.trim() !== '');
        console.log('保存したお題:', titles);
        alert('お題リストを保存しました（ブラウザのみ）');
        editTitleModal.style.display = 'none';
    };

    // モーダル外クリックで閉じる
    editTitleModal.onclick = function(event) {
        if (event.target === editTitleModal) {
            editTitleModal.style.display = 'none';
        }
    };
    
    // ゲーム画面に戻るボタン
    document.getElementById('backToGameBtn').onclick = function() {
        window.location.href = 'index.html';
    };
    </script>
</body>
</html>
